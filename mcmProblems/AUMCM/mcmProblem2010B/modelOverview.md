## 目标

开发一种预测，这种预测需提供一些类似于建立在过去几次犯罪现场的时间和地点数据的基础上，对下一犯罪发生的可能地点的评估或者指导。即**寻找其袭击位置的“混乱中心”。**

## 难点

如何建立连环杀手犯罪行为的模型

## 假设

假设搜索区域为一个城市，该区域是一个潜在的犯罪现场，嫌疑犯的活动不受到任何条件的约束，并且该区域足够大能包括所有的搜索点。需要注意的是：罪犯的犯罪地点将会在郊区、农村、甚至延伸到城镇，犯罪经常发生的城市的某一地区。以下为三个城市化的条件：

1. 整个区域为一个潜在的犯罪现场：每一个小区域都包含一个可能犯罪地点。
2. 罪犯的活动不受限制。由于现实中量的实际距离很难计算，我们使用“**曼哈顿假设”**：城市内有足够的人行道和路线成网格状，并假设罪犯运动沿路线运动。肯特表明在一些连环案件中**欧几里得距离与曼哈顿距离**在预测锚点是可以互换。
3. 区域包括所有的搜索点。这个条件表明以上两个条件必须在区域足够大前提下。


## 建模方法

研究人员已经发现并评估了发掘这些犯罪中心的方法，**将犯罪中心作为犯罪事件的锚点来研究。**

### 单锚点方案（重心法）

1. 建立搜索区域

   发现犯罪地点的中心：锚点定义为$n$个犯罪地点（$x_i，y_i$）的均值。以过去犯罪情况的数据点群中的距离最大值为正方形的边长，这个方域能够包含所有先前犯罪地点，然后把边长放大三倍。这就使得关于所有可能区域的基本假设都成立。

2. 计算犯罪地点的重心

3. **建立似然点（难）**

   围绕一个锚点的连环犯罪模式有两个支配性理论：

   **在锚点附近存在一个缓冲带**。罪犯在一个以锚点为中心的圆环域内实施犯罪。这个理论经常用数列{$X_i$}的均值和方差为参数的高斯曲线的正半部分来模仿。

   高斯曲线（正态分布）的概率密度函数为：$f(x)=\frac1{\sqrt{2π}σ}e^{\frac{-1}{2σ^2}(x-μ)^2}$

   它的均值为：$μ$  它的方差为：$σ^2$

   **犯罪符合来自一个锚点的衰减的指数模式。**考虑到伽马分布的灵活性，当点距离比较远时它有可变的高斯模型的特征。但是当参数比较小的时候，曲线近似于负指数函数。

   定义随机变量$X_i$为第$i$个犯罪点到锚点$r$的距离，假设$X_i$是独立的，

   它的分布函数为：$X_i ∼ Γ(k, θ)$，

   它的概率密度函数为：$f(x; k, θ) = \frac{θ^k}{Γ(k)}x^{k−1}e^{−θx}$。

   它的均值为：$\fracκθ$方差为：$\fracκ{θ^2}$

   通过MATLAB中的ganfit函数来估计参数$k$和$θ$。然后我们用分布结果建立了可能犯罪点的似然点。对于搜索范围内的每一个点，我们都计算它的密度。然后标准化使得似然面下的体积和之是精确的值1。

4. 调整预测犯罪趋势

   解释任何放射趋势的犯罪（罪犯越大胆越接近或远离罪犯的家），给定一个新的随机变量的期望。

5. 对先前的犯罪地点赋权

6. 输出可能的犯罪地点

   为了评价我们的模型，我们以三起连环强奸案的数据作为输入。在每一个测试个例中，我们去除最后一次犯罪的数据点，生成一个似然面$Z(x,y)$。然后我们预测最后一次案发的地点并比较标准的有效率。

   ***如何比较有效率***

   $κ_s = \frac{Z_{our model}(CrimePoint)}{Z_{flat}(CrimePoint)}$

   我们通过比较每个模型的有效率来判定哪个模型更优。$k$是该点资源配置的比值，在总资源一样的情况下，我们计算$k$值，$Z_i$是模型$i$的似然函数即实际下一个案件发生的位置。我们比较我们的结果与随机预测结果的比值有效率。如果$k=1$那么我们的模型与随机预测结果一样，如果$k＜1$，则表示我们的模型结果不随机预测结果好，如果$k＞1$则我们的模型比随机预测结果好。

### 多锚点方案（聚类法）

假设至少两个锚点（例如，家，工作地点），把每一个作为他们自己局部犯罪重心。这种方法确定一个适当数量的族群，这使得我们能够得到以前的犯罪地点。

分层聚类分析法可以分三步完成：

1. 用欧几里得距离计算所有犯罪地点之间的距离。

2. 把所有的距离表示在聚类谱系图中，用树状图代表。树状图的数据点P1, . . . , PN是建立在每个数据点都有自己的群集的假设基础上。

3. 合并这两个最靠近（它们的图心距）的群集，继续这样做直到这两个群集达到研究所想要的数据。在聚类图中绘制了这些群集合并的水平线，它们的高度是由两个合并群集之间的距离决定的。

   ***确定最佳聚类的群集数***

   使用了$silhouettes$的概念。我们定义$a(P_i)$为$P_i$到它本身所在群集中每个点的平均距离，$b(P_i,k)$为$P_i$点到群集$C_k$（不包括$P_i$的群集）每个点的平均距离。然后$P_i$的$silhouettes$值为：

   $s(P_i) =\frac{[\mathop {\min }\limits_{k|P_i∉C_k}b(P_i,k)]-a(P_i)}{\mathop{\max}(a(P_i),\mathop {\min }\limits_{k|P_i∉C_k}b(P_i,k))}$

   这个表达式在$[1,-1]$上取值，$s(P_i)$越接近1，则$P_i$越适合当前的群集，$P_i$的值越接近$-1$越不适合当前的群集。

   为了优化群集的数量，我们计算了分为$2，3，4$个群集的形式。然后对于每种不同数量的群集分类，我们计算了每一个点(不仅仅是群集内的点）的$silhouettes$值。（我们忽略单一点群集的$silhouettes$值，因为这个群集会影响平均数）然后我们要找3个平均$silhouettes$值的最大值，即为最优群集数。

   ***群集循环算法***

   如果一个群集包含单个的点，我们不认为这种群集代表一个锚点，相反我们把这一点作为一个异常值。我们利用以一个点为中心的高斯分布（正态分布）作为似然面，同时对伽玛分布的期望求均值，并将其作为每个非单点群集的锚点的值。

### 复合方案

先对a,b,c三个罪犯用聚类的方法，因为在使用重心法之前，聚类法能拒绝三个统计异常值。对于高度集中的单一数据群集，其没有异常值，这种情况下，重心法在任何条件下都优于聚类法。

### 模型与随机猜测、直观性观察等方法相对比

1. 该种预测方法是基于测试了在大量真实数据的连环杀人案的假设趋势下进行的。
2. 类似的数学技术被用于锚点估计方案，当测试交叉数据样本时该技术始终优于随机猜测。
3. 与犯罪心理学和有经验的警官相比较

## 仿真

###投入

我们的模型需要一个连环案罪犯的犯罪以前的坐标位置，以及罪犯的犯罪顺序。

 ### 假设

1. 罪犯倾向于打击的位置在个或多个锚点的位置。（通常，罪犯的家里）

2. 在这个锚点周围可能有罪犯不能打极大的“缓冲区”。

3. 如果罪犯存在多个锚点，从那些他经常打击或最近打击的地区周围更有可能性。


###方法


1.  两个不同模型不同算法的工具，然后决定哪个更好
2.  方法一假设罪犯有单一锚点，在他过去犯罪的基础上建立区域可能性。
3.  方法二假设存在多个锚点，计算出最好的锚点使用，决定在每个点的可能  性。考虑每一个被罪犯显然首选的地区的周围。
4.  最后，该算法测试两种模型，看看他们怎样更好的预测前面的罪行和更好地使用模型